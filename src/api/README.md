<h1 align="center">Remote CNC API</h1>

<h4 align="center">
	ðŸš§ Remote CNC API ðŸš€ Under construction...  ðŸš§
</h4>

<hr>

<p align="center">
  <a href="#dart-about">About</a> &#xa0; | &#xa0;
  <a href="#checkered_flag-development">Development</a> &#xa0; | &#xa0;
  <a href="#checkered_flag-installation">Installation</a> &#xa0; | &#xa0;
  <a href="#rocket-deploy-changes">Deploy changes</a> &#xa0; | &#xa0;
  <a href="#rocket-access-outside-local-intranet">Access outside local intranet</a>
</p>

<br>

## :dart: About

API to remotely monitor and manage an Arduino-based CNC machine.

## :checkered_flag: Development

See [Development](./docs/development.md) docs.

### Running the API locally (without Docker)
TBD

## :checkered_flag: Installation

See [Server setup](./docs/server-setup.md) docs.

## :rocket: Deploy changes

See [Deployment](./docs/deployment.md) docs.

## :rocket: Access outside local intranet

As the API will almost certainly be hosted in a private network, behind a NAT router, we need a way to expose it to the outside world, in order for the cloud-hosted web app (or any external user) to access it. To do that, maybe the easiest option is to use a tunneling service like [Ngrok](https://ngrok.com).

```bash
$ ngrok http 8000 --scheme http,https
```

The command above will open a secure tunnel via one of the Ngrok servers and we'll be given a randomly generated URL (in Ngrok terminology, *ephemeral domain*), which we shall set as environment variable in our remote app server. Take into account that you will have to update your app server's environment each time you init the Ngrok tunnel.

An option to circumvent that problem, is to set up a *static domain* in your [Ngrok dashboard](https://dashboard.ngrok.com/cloud-edge/domains). You can read more about Ngrok domains in the [docs](https://ngrok.com/docs/network-edge/domains-and-tcp-addresses/#domains).

```bash
$ ngrok http --domain={{my-static-domain}} 8000 --scheme http,https
```

**NOTE:** We recommend using a static domain for production, and ephemeral domains to test the connection between the web app and the API in development environment/branches.

### Docker

We provide an optional service for `Ngrok` to run with `docker compose`. To run it, you must allow the services with [profile](https://docs.docker.com/compose/profiles/) *ngrok* when running `docker compose up`.

```bash
$ docker compose --profile=ngrok up -d
```

To know the ephemeral URL generated by Ngrok, you can access [Ngrok dashboard](http://localhost:4040/status) in your browser or, if you are using Linux, run the following command:

```bash
$ curl -s localhost:4040/api/tunnels | jq -r '.tunnels[0].public_url'
```

<a href="#top">Back to top</a>
